{
    "version": 3,
    "sources": [
        "../../../src/admin/controller/menu.js"
    ],
    "names": [
        "init",
        "http",
        "indexAction",
        "pid",
        "param",
        "assign",
        "display",
        "loadmenuAction",
        "model",
        "loadMenuTable",
        "post",
        "data",
        "json",
        "addAction",
        "getDictByGroupCode",
        "icon",
        "think",
        "isEmpty",
        "addmenuAction",
        "menu",
        "response_data",
        "status",
        "msg",
        "config",
        "code",
        "url",
        "name",
        "briefname",
        "ismenu",
        "sort",
        "create_time",
        "times",
        "Date",
        "addMenu",
        "res",
        "type",
        "editAction",
        "findMenuById",
        "delAction",
        "delMenu",
        "sortAction",
        "sortMenu",
        "JSON",
        "parse",
        "result"
    ],
    "mappings": "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",
    "file": "../../../src/admin/controller/menu.js",
    "sourcesContent": [
        "// +----------------------------------------------------------------------\r\n// | ThinkJS-RABC [ 通用权限管理系统 ]\r\n// +----------------------------------------------------------------------\r\n// | Nanjing Digital Technology Co., Ltd.\r\n// +----------------------------------------------------------------------\r\n// | Copyright (c) 2017 http://www.51-health.com All rights reserved.\r\n// +----------------------------------------------------------------------\r\n// | Author: Devlin <Devlinheart@qq.com>\r\n// +----------------------------------------------------------------------\r\n// | Create: 2017-06-20\r\n// +----------------------------------------------------------------------\r\n\r\n'use strict';\r\n\r\nimport Base from './base.js';\r\n\r\nexport default class extends Base {\r\n\r\n    init(http){\r\n        this.http = http;\r\n    }\r\n    async indexAction(){\r\n        let pid = this.param(\"pid\")||0;\r\n        this.assign(\"pid\",pid);\r\n        return this.display();\r\n    }\r\n    /**\r\n     * 加载数据\r\n     */\r\n    async loadmenuAction(){\r\n        let  data = await this.model(\"menu\").loadMenuTable(this.post(\"pid\")||0,this.post(\"offset\"),this.post(\"limit\"),\"sort\",this.param(\"param\"));\r\n        return this.json(data);\r\n    }\r\n    /**\r\n     * 新增菜单\r\n     */\r\n    async addAction(){\r\n        let icon = await this.model(\"dict\").getDictByGroupCode(\"sys_dict_group_icon\");\r\n        if(!think.isEmpty(icon)){\r\n            this.assign(\"icon\",icon);\r\n        }\r\n        return this.display();\r\n    }\r\n    async addmenuAction(){\r\n        let menu = {};\r\n        let response_data ={\r\n            status:1,\r\n            msg:think.config(\"message.success_msg\")\r\n        }\r\n        if(!think.isEmpty(this.param(\"code\"))){\r\n            menu.code = this.param(\"code\");\r\n        }\r\n        else{\r\n            response_data.status = 0;\r\n            response_data.msg = think.config(\"message.empty_param\")\r\n            return this.json(response_data);\r\n        }\r\n        if(!think.isEmpty(this.param(\"url\"))){\r\n            menu.url = this.param(\"url\");\r\n        }\r\n        else{\r\n            response_data.status = 0;\r\n            response_data.msg = think.config(\"message.empty_param\")\r\n            return this.json(response_data);\r\n        }\r\n        if(!think.isEmpty(this.param(\"name\"))){\r\n            menu.name = this.param(\"name\");\r\n            menu.briefname = this.param(\"name\");\r\n        }\r\n        else{\r\n            response_data.status = 0;\r\n            response_data.msg = think.config(\"message.empty_param\")\r\n            return this.json(response_data);\r\n        }\r\n        if(!think.isEmpty(this.param(\"ismenu\"))){\r\n            menu.ismenu = this.param(\"ismenu\");\r\n        }\r\n        else{\r\n            response_data.status = 0;\r\n            response_data.msg = think.config(\"message.empty_param\")\r\n            return this.json(response_data);\r\n        }\r\n        if(!think.isEmpty(this.param(\"sort\"))){\r\n            menu.sort = this.param(\"sort\");\r\n        }\r\n        else{\r\n            response_data.status = 0;\r\n            response_data.msg = think.config(\"message.empty_param\")\r\n            return this.json(response_data);\r\n        }\r\n        if(!think.isEmpty(this.param(\"icon\"))){\r\n            menu.icon = this.param(\"icon\");\r\n        }\r\n        else{\r\n            response_data.status = 0;\r\n            response_data.msg = think.config(\"message.empty_param\")\r\n            return this.json(response_data);\r\n        }\r\n        if(!think.isEmpty(this.param(\"pid\"))){\r\n            menu.pid = this.param(\"pid\");\r\n        }\r\n        else{\r\n            response_data.status = 0;\r\n            response_data.msg = think.config(\"message.empty_param\")\r\n            return this.json(response_data);\r\n        }\r\n        menu.status = 1;\r\n        menu.create_time = times(new Date(),true);\r\n        let res = await this.model(\"menu\").addMenu(menu);\r\n        if(!think.isEmpty(res)){\r\n            if(res.type=='exist'){\r\n                response_data.status = 0;\r\n                response_data.msg = think.config(\"message.data_exist_msg\")\r\n            }\r\n        }\r\n        else{\r\n            response_data.status = 0;\r\n            response_data.msg = think.config(\"message.fail_msg\")\r\n        }\r\n        return this.json(response_data);\r\n    }\r\n    /**\r\n     * 编辑\r\n     */\r\n    async editAction(){\r\n        if(!think.isEmpty(this.param(\"id\"))){\r\n            let menu = await this.model(\"menu\").findMenuById(this.param(\"id\"));\r\n            this.assign(\"menu\",menu);\r\n        }\r\n        let icon = await this.model(\"dict\").getDictByGroupCode(\"sys_dict_group_icon\");\r\n        if(!think.isEmpty(icon)){\r\n            this.assign(\"icon\",icon);\r\n        }\r\n        return this.display();\r\n    }\r\n    /**\r\n     * 删除\r\n     */\r\n    async delAction(){\r\n        let response_data ={\r\n            status:0,\r\n            msg:think.config(\"message.empty_param\")\r\n        }\r\n        if(!think.isEmpty(this.param(\"id\"))){\r\n            let res = this.model(\"menu\").delMenu(this.param(\"id\"));\r\n            if(!think.isEmpty(res)){\r\n                response_data.status = 1;\r\n                response_data.msg=think.config(\"message.del_success_msg\");\r\n            }\r\n            else{\r\n                response_data.status = 0;\r\n                response_data.msg=think.config(\"message.del_fail_msg\");\r\n            }\r\n        }\r\n      \r\n        return this.json(response_data);    \r\n    }\r\n    /**\r\n     * 排序\r\n     */\r\n    async sortAction(){\r\n        let response_data ={\r\n            status:0,\r\n            msg:think.config(\"message.empty_param\")\r\n        }\r\n        if(!think.isEmpty(this.param(\"menu\"))){\r\n            let result = await this.model(\"menu\").sortMenu(JSON.parse(this.param(\"menu\")));\r\n            if(!think.result){\r\n                response_data.status = 1;\r\n                response_data.msg = think.config(\"message.success_msg\");\r\n            }\r\n            else{\r\n                response_data.msg = think.config(\"message.fail_msg\");\r\n            }\r\n        }\r\n        return this.json(response_data);    \r\n    }\r\n}"
    ]
}